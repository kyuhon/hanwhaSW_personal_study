report 정리

신고생성

신고에 있는 suspensionCycle컬럼에 회원테이블의 정지횟수를 넣는다
	suspensionCycle의 컬럼 존재 이유
		신고테이블에 저장되는 인스턴스가 hard delete가 아닌 soft delete를 적용해서 이전 기록과 구분하기 위해
		회원의 정지 기준에서 이전 인스턴스의 갯수를 제외하고 새로 생성된 갯수를 확인하기 위해서

신고에 대한 예외처리
회원테이블에서 상태가 정지이거나 블랙리스트이면 예외처리 1,2
해당 게시판의 게시글이 존재하지 않으면 예외처리 4
해당 게시판의 작성 아이디와 신고대상 아이디가 일치하지 않으면 예외처리 5
해당 신고가 신고되었거나 신고가 승인되지 않지 않은 것에 대한 예외처리 9

	예외처리 설정추가
		config 패키지에 예외처리만 담당하는 클래스파일 추가

정상적인 신고처리 상태 10





신고업데이트

해당 신고가 Y나 U로 변경
	Y는 신고승인. U는 신고 미승인, default는 N으로 신고 중인 상태



상태가 Y로 변경되었을 시에

	responseBody에 있는 result 값이 updated이면 그냥 상태 변경이고 BAN이나 BLACKLIST이면 해당 테이블 인스턴스 추가 11

	신고테이블에 있는 신고 카테고리번호가 신고 카테고리 테이블에 존재하지않으면 예외처리 12

	신고된 신고자의 아이디의 인스턴스 중에서 member테이블의 해당 회원의 정지횟수에 대한 컬럼값이
	Report 테이블의 SuspensionCycle이 일치하고, 신고의 카테고리 아이디가 일치하고, 신고상태가 Y인 인스턴스
	의 개수를 확인한다
		그 개수가 10개 이상이거나 해당 신고 카테고리아이디와 일치하는 ReportCategory 테이블에 있는
		countStandard개수와 일치하면 회원 정지 테이블에 해당 회원의 인스턴스가 생성되고 
		Member테이블에 해당 회원의 회원상태가 3으로 변경된다
			13~20
		신고된 신고의 카테고리아이디가 ReportCategory 테이블에 있는 countStandard가 0인 카테고리 아이디는 
		신고승인 즉시 블랙리스트 처리가 되고 Member 테이블에 해당 회원의 상태가 5로 변경된다
			21~24
	Member테이블의 상태변경은 MSA에 의한 회원 서비스를 다른 서버로 분리과정에서 락 발생으로 인해
	Member 테이블에 업데이트 발생 시 @TransactionalEventListener를 사용하여
	이전 트랜잭션이 커밋된 이후 실행할 수 있게 코드변경


신고 정지 event (db서버 event)

매일 자정, enddate가 자정 시간 기준으로 이전이면 member테이블의 상태가 정상인 1로 변경


수정사항 10.13

같은 회원이 신고 못하게
회원신고추가 
크루신고 -> report의 외래키를 member가 아닌 크루멤버로 등록
4번 정지후 result값 blacklist
4번째 정지했을 때 정지테이블에 4번째는 등록되지 않게 
풀리퀘스트 자정 이벤트 ddl 수정
이의신청...
신고 승인됐을때
	크루게시판과 자유게시판 softDelete
	댓글 hardDelete
- 신고 관리자 (몇회 이상 관리자 확인 할건지 알람 기준? )
    - 5건 이상 동일 신고로 들어오면 관리자 확인
    - 영구정지 기준은 바로 알람이뜨도록
		이 부분은 어떻게 할지 고민해보기...
마지막으로 포스트맨으로 확인 이후 테스트코드작성