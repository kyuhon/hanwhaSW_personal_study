report 정리

신고생성

신고에 있는 suspensionCycle컬럼에 회원테이블의 정지횟수를 넣는다
	suspensionCycle의 컬럼 존재 이유
		신고테이블에 저장되는 인스턴스가 hard delete가 아닌 soft delete를 적용해서 이전 기록과 구분하기 위해
		회원의 정지 기준에서 이전 인스턴스의 갯수를 제외하고 새로 생성된 갯수를 확인하기 위해서

신고에 대한 예외처리
회원테이블에서 상태가 정지이거나 블랙리스트이면 예외처리 1,2
해당 게시판의 게시글이 존재하지 않으면 예외처리 4
해당 게시판의 작성 아이디와 신고대상 아이디가 일치하지 않으면 예외처리 5
해당 신고가 신고되었거나 신고가 승인되지 않지 않은 것에 대한 예외처리 9

	예외처리 설정추가
		config 패키지에 예외처리만 담당하는 클래스파일 추가

정상적인 신고처리 상태 10





신고업데이트

해당 신고가 Y나 U로 변경
	Y는 신고승인. U는 신고 미승인, default는 N으로 신고 중인 상태



상태가 Y로 변경되었을 시에

	responseBody에 있는 result 값이 updated이면 그냥 상태 변경이고 BAN이나 BLACKLIST이면 해당 테이블 인스턴스 추가 11

	신고테이블에 있는 신고 카테고리번호가 신고 카테고리 테이블에 존재하지않으면 예외처리 12

	신고된 신고자의 아이디의 인스턴스 중에서 member테이블의 해당 회원의 정지횟수에 대한 컬럼값이
	Report 테이블의 SuspensionCycle이 일치하고, 신고의 카테고리 아이디가 일치하고, 신고상태가 Y인 인스턴스
	의 개수를 확인한다
		그 개수가 10개 이상이거나 해당 신고 카테고리아이디와 일치하는 ReportCategory 테이블에 있는
		countStandard개수와 일치하면 회원 정지 테이블에 해당 회원의 인스턴스가 생성되고 
		Member테이블에 해당 회원의 회원상태가 3으로 변경된다
			13~20
		신고된 신고의 카테고리아이디가 ReportCategory 테이블에 있는 countStandard가 0인 카테고리 아이디는 
		신고승인 즉시 블랙리스트 처리가 되고 Member 테이블에 해당 회원의 상태가 5로 변경된다
			21~24
	Member테이블의 상태변경은 MSA에 의한 회원 서비스를 다른 서버로 분리과정에서 락 발생으로 인해
	Member 테이블에 업데이트 발생 시 @TransactionalEventListener를 사용하여
	이전 트랜잭션이 커밋된 이후 실행할 수 있게 코드변경


신고 정지 event (db서버 event)

매일 자정, enddate가 자정 시간 기준으로 이전이면 member테이블의 상태가 정상인 1로 변경


수정사항 10.13

같은 회원이 신고 못하게
회원신고추가 
크루신고 -> report의 외래키를 member가 아닌 크루멤버로 등록
4번 정지후 result값 blacklist
4번째 정지했을 때 정지테이블에 4번째는 등록되지 않게 
풀리퀘스트 자정 이벤트 ddl 수정
이의신청...
신고 승인됐을때
	크루게시판과 자유게시판 softDelete
	댓글 hardDelete
마지막으로 포스트맨으로 확인 이후 테스트코드작성



10.15 관리자 페이지 피그마(v1.0 - 기본 틀만들고 추가하기)


백에서 구현된거 위주로 작성
마이페이지에 이의신청 기능
구글 애널리틱스 사용법 찾아보기

회원조회
	역할별 회원 조회
		회원 기본정보 - 아이디, 본명, 이메일, 비밀번호, 닉네임, 생일, 성별
		회원 로그인정보 - 아이디, 로그인날짜, 마지막 로그인, 로그인 실패횟수, 계정 탈퇴일시, 로그인 제한 시간
		회원 등급 및 상태코드 - 아이디 점수(등급 산정 기준), 회원등급 ID, 회원상태코드, 크루번호
	회원 상태 변경(MemStsId) 수정

	회원 수 변화
		1주일, 1달, 1년
	
	로그인 이력
		1주일, 1달

	로그인 실패이력
		1주일, 1달

상태 추가 및 수정

	테이블
		MemberRank

신고
	게시판 쪽 페이지네이션 가져오기
	1. 자유게시판, 크루, 댓글별 조회및 상태 수정
		[변경사항] 미승인이 N으로 되어있고 U가 취소상태인데 변경예정
		[변경사항] 관리자 승인 시 로그인 된 관리자 ID 신고 테이블에 입력
	2. 이의신청 조회
		[변경사항] 수락 및 거절로 인한 상태변경 
			1의 화면구현과 거의 유사
		마이페이지에 로그인한 회원의 신고가 수락된 신고 조회 -> 이의 신청 
			-> 이의신청된 신고 이의신청 수락이나 거절
				개인 신고조회, 이의신청 내역
		[변경사항] 이의 신청 확인이 됐는지 확인하는부분
	3. 회원정지 조회(Ban table)
		회원정지 전체조회 
		회원정지 확인을 위해 adminId가 등록되어있지 않으면 확인버튼을 통해 해당 로그인된 관리자 id 등록
		회원정지가 이상하다면 해당 정지 보류 -- 예정
		[변경사항] 회원정지 확인 시 회원정지에 대한 주석 입력 후 확인 입력 시 해당 인스턴스 관리자 ID입력
					벤 테이블에 주석 컬럼 추가
	4. 블랙리스트 조회(Blacklist table)
		블랙리스트 전체조회
		[변경사항] 블랙리스트가 된 회원의 신고내역 조회
		[변경사항] 블랙리스트 확인 시 블랙리스트에 대한 주석 입력 후 확인 입력 시 해당 인스턴스 관리자 ID입력
					블랙리스트 테이블에 주석 컬럼 추가
산 및 코스

크루


10.17
주말에 할일
	피그마 관리자 페이지 신고 마무리
		마이페이지에 신고받은 목록창, 이의신청 페이지 만들기
	백엔드 회원신고 이의신청 만들기
	html, css 사용해서 디자인 만들어놓기
	자바스크립트 기초 14_js 다시 보기
	위치기반을 지도에 띄우는게 가능한가?
	구글 아날리틱스 사용해보기
