렌탈 테스트 프로젝트 정리본 작성

만료 되었을 때 점검중으로 바뀌고 하루가 지나면 대여가능 check
결재전부 승인 시 알림처리 미완성으로 로직삭제


계약목록 페이지네이션 중앙정렬
프로모션, 쿠폰 계약 체크박스(한번 클릭후에 체크해제가 안됨)


해지요청
해당 계약의 상태가 진행중(P)에서 해지(T)로 변경후에 계약에서 렌탈중인 상품이 연체로 변경 check




api , 프로그램 사양서(강사님 공지사항 확인)




견적 추가 더미데이터 
견적을 한 시기, 아이디 등 순서가 맞지않음


계약관리
develop
배포 *********************


프론트
전체계약 상태 건수 표시에 '결제 대기와 결제 거절을 제외한 누적 계약'로 단어 수정
각 페이지에 http method 부분 approval.js와 contract.js 에 로직 분리 및 로직 정리
완료상태 페이지네이션 추가 및 백엔드 완료상태 수정
계약 생성시 결재날짜 선택할 떄 현재 날짜 이전 날짜는 선택 못하게 설정
계약 생성시 적용가능한 프로모션 내역과 선택 부분 정렬


백
ContractApprovedEvent 레코드 사용해서 인증시 기안자에게 알림
계약 생성 시에 계약 상품 중복 검증
결제 거절 시 해당 제품 렌탈 상태 대여가능(P)으로 변경
결제내역 승인 시 해당 제품의 매출량 증가
결재관리에서 완료상태 get요청 쿼리 수정
전체 계약 승인 요청 후 결재내역 생성시 overdue_days를 null이 아닌 0으로 추가
결재내역 미납 변경 시 pay_overdue에 인스턴스 생성



서진
itemRepo 에 추가
쿠폰 end_date 컬럼 목적
createIssuedCoupon 수정

창훈
PayOverdue 엔티티 set 추가

지현
알림기능 ContractApprovedEvent 


마지막 승인요청 시 해당 쿠폰사용기록 Y로 변경되게 로직을 짜야할텐데..
계약 상세보기에서 만료임박 계약진행률 0으로 나옴 아닌데?? 모지?
2026년 시퀀스 변경 **
신규계약 상태는 계약 시작일 기준이 아닌 결재에서 결재일 기준
계약 만료 이후 해당 장비 상태변경을 해야하나...
해지나 만료시에 반납처리...
계약 생성시 쿠폰 사용기록 N  **


------------------------------------------------------------------------------------------

------------------계약관리 정리본------------------

계약생성

ContractCommandServiceImpl
계약 생성의 단일 진입점(Aggregate Root 역할)

로그인/권한 검증 -> 결재선 요청 형태 판단 -> 계약 생성 -> 프로모션/쿠폰 로그 기록
 -> 결재 문서 + 결재 단계 매핑 생성 -> 렌탈 아이템 선점 ( 재고 차감 + 계약 - 아이템 매핑 )
-> 트랜잭션 커밋 -> 고객 세그먼트 전환 트리거

계약 상태 자동 변경 스케쥴러


PaymentDetailCommandServiceImpl
계약에 의해 생성된 월별 결제 스케줄의 상태 변경을 전담

결제 완료 요청 -> 결제 내역 상태 검증 -> 결제 완료 처리 -> 계약 기준 아이템 매출 누적

미납 처리 요청 -> 결제 가능 여부 검증 -> 미납 처리 + 연체 일수 계산 -> 미납 이력 생성

스케쥴러 -> 미납 상태 결제 건 연체 일수+1

------------------결재관리 정리본------------------

sql 가독성, 유지보수, 페이징 안정성, 책임분리의 목적을 위해 view를 사용해서 결재관리 조회를 만듬


ApprovalCommandServiceImpl
승인 처리 흐름
ApprovalMapping 단건 승인 -> 결재 권한과 단계 검증 -> 다음 결재자 남았는지 확인
-> 모두 승인 시 결재 완료 + 계약 활성화 + 결제 스케줄 생성 + 알림 발행

반려 처리 흐름
1. 권한/ 상태검증(본인 결재인지, 이미 처리된건 아닌지, 이전 단계가 완료되었는지)
2. 현재 결재자 반려처리
3. 결재/계약 상태 반려 전파
4. 렌탈 아이템 상태 롤백

견적 더미 시퀀스 생성기가 안먹힌다...
더미쌓기
2026년 


------------------------------------------------------------------------------------------------------------------------


12.30 정리본

뒤에 시간 통일
검색바 통일
등록바 통일


계약 생성 페이지네이션 변경 ㄴㄴㄴㄴ
계약 기본 정보에서 고객명 추가
내 결재내역 변경
코드변경확인하기


서진
page-container 패딩주기
코드 변경 확인하기

승우
계약 상태변경 수동으로 변경하는 부분
	현재는 만료임박, 진행 중 상태일 때 해지로 변경 가능
	고객목록쪽 고민하고있다...

형석
내일 휴가여서 오늘 안에 쇼부봐야함


지현
api 엔드포인트 오픈서치 다운필요

창훈
CI/CD 계획서


계약 기본 정보에서 고객명 추가
결재관리페이지에서 계약페이지로 router이동
만원으로 입력표시 수정


프로그램 사양서 초안

